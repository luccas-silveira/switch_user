var SwitchUser=(()=>{var v=Object.defineProperty;var V=Object.getOwnPropertyDescriptor;var Q=Object.getOwnPropertyNames;var Z=Object.prototype.hasOwnProperty;var J=(o,e)=>{for(var t in e)v(o,t,{get:e[t],enumerable:!0})},K=(o,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Q(e))!Z.call(o,n)&&n!==t&&v(o,n,{get:()=>e[n],enumerable:!(i=V(e,n))||i.enumerable});return o};var X=o=>K(v({},"__esModule",{value:!0}),o);var re={};J(re,{default:()=>ie,getDropdown:()=>A,startApp:()=>y});var Y={namespace:"ui-injector",version:"1.0.0",debug:!1,cssIsolation:"shadow-dom",mountTarget:null,mountPosition:"body-end",zIndexBase:999e3,domTimeout:5e3,retryInterval:100,maxRetries:50,observeMutations:!0,hooks:{onBeforeInit:null,onAfterInit:null,onBeforeMount:null,onAfterMount:null,onBeforeDestroy:null,onAfterDestroy:null,onError:null}},x={...Y};function d(){return{...x}}function I(o){return x={...x,...o,hooks:{...x.hooks,...o.hooks||{}}},d()}function l(){return x.namespace}function S(o,e={}){let t=d(),{timeout:i=t.domTimeout,interval:n=t.retryInterval,parent:a=document}=e;return new Promise((s,w)=>{let E=a.querySelector(o);if(E){s(E);return}let G=Date.now(),N=setInterval(()=>{let D=a.querySelector(o);if(D){clearInterval(N),s(D);return}Date.now()-G>=i&&(clearInterval(N),w(new Error(`Timeout: elemento "${o}" n\xE3o encontrado`)))},n)})}function j(){return new Promise(o=>{document.readyState==="loading"?document.addEventListener("DOMContentLoaded",o,{once:!0}):o()})}function C(o,e={},t=[]){let i=document.createElement(o);return Object.entries(e).forEach(([a,s])=>{if(a==="className")i.className=s;else if(a==="style"&&typeof s=="object")Object.assign(i.style,s);else if(a.startsWith("on")&&typeof s=="function"){let w=a.slice(2).toLowerCase();i.addEventListener(w,s)}else a==="dataset"&&typeof s=="object"?Object.entries(s).forEach(([w,E])=>{i.dataset[w]=E}):i.setAttribute(a,s)}),(Array.isArray(t)?t:[t]).forEach(a=>{typeof a=="string"?i.appendChild(document.createTextNode(a)):a instanceof Node&&i.appendChild(a)}),i}function M(o=""){let e=l(),t=Math.random().toString(36).substring(2,9);return`${e}-${o?o+"-":""}${t}`}function T(o){o&&o.parentNode&&o.parentNode.removeChild(o)}var B=`
  :host {
    /* Cores prim\xE1rias */
    --ui-color-primary: #3b82f6;
    --ui-color-primary-hover: #2563eb;
    --ui-color-primary-light: #dbeafe;

    /* Cores de texto */
    --ui-color-text: #1f2937;
    --ui-color-text-muted: #6b7280;
    --ui-color-text-light: #9ca3af;

    /* Cores de fundo */
    --ui-color-bg: #ffffff;
    --ui-color-bg-secondary: #f9fafb;
    --ui-color-bg-tertiary: #f3f4f6;

    /* Cores de borda */
    --ui-color-border: #e5e7eb;
    --ui-color-border-dark: #d1d5db;

    /* Cores de status */
    --ui-color-success: #10b981;
    --ui-color-warning: #f59e0b;
    --ui-color-error: #ef4444;
    --ui-color-info: #3b82f6;

    /* Sombras */
    --ui-shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    --ui-shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    --ui-shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);

    /* Espa\xE7amento */
    --ui-spacing-xs: 4px;
    --ui-spacing-sm: 8px;
    --ui-spacing-md: 16px;
    --ui-spacing-lg: 24px;
    --ui-spacing-xl: 32px;

    /* Tipografia */
    --ui-font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    --ui-font-size-xs: 12px;
    --ui-font-size-sm: 14px;
    --ui-font-size-md: 16px;
    --ui-font-size-lg: 18px;
    --ui-font-size-xl: 20px;

    /* Bordas */
    --ui-radius-sm: 4px;
    --ui-radius-md: 6px;
    --ui-radius-lg: 8px;
    --ui-radius-full: 9999px;

    /* Transi\xE7\xF5es */
    --ui-transition-fast: 150ms ease;
    --ui-transition-normal: 250ms ease;
    --ui-transition-slow: 350ms ease;

    /* Z-index */
    --ui-z-dropdown: 100;
    --ui-z-modal: 200;
    --ui-z-tooltip: 300;
    --ui-z-toast: 400;
  }
`,F=`
  *, *::before, *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  :host {
    font-family: var(--ui-font-family);
    font-size: var(--ui-font-size-md);
    color: var(--ui-color-text);
    line-height: 1.5;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  button, input, select, textarea {
    font-family: inherit;
    font-size: inherit;
  }

  button {
    cursor: pointer;
    border: none;
    background: none;
  }

  a {
    color: inherit;
    text-decoration: none;
  }

  img, svg {
    display: block;
    max-width: 100%;
  }

  [hidden] {
    display: none !important;
  }
`;function $(){return`${B}
${F}`}function m(o,e){let t=l(),i=new Date().toISOString().split("T")[1].split(".")[0];return`[${t}][${i}][${o}] ${e}`}var ee={debug(o,...e){d().debug&&console.log(m("DEBUG",o),...e)},info(o,...e){console.info(m("INFO",o),...e)},warn(o,...e){console.warn(m("WARN",o),...e)},error(o,...e){console.error(m("ERROR",o),...e);let t=d();if(t.hooks.onError)try{t.hooks.onError(new Error(o),e)}catch(i){console.error(m("ERROR","Erro no hook onError"),i)}},group(o,e){if(d().debug){console.groupCollapsed(m("GROUP",o));try{e()}finally{console.groupEnd()}}}},r=ee;var L=class{constructor(){this.styleSheets=new Map,this.shadowRoot=null}setShadowRoot(e){this.shadowRoot=e}_getStyleId(e){return`${l()}-style-${e}`}_prefixSelectors(e){let t=l();return e.replace(/([^\r\n,{}]+)(,(?=[^}]*{)|\s*{)/g,(i,n,a)=>{let s=n.trim();return s.startsWith("@")||s.startsWith(":root")||s.startsWith(":host")?i:`.${t} ${s}${a}`})}inject(e,t){let i=d(),n=this._getStyleId(e);this.remove(e);let a=t;i.cssIsolation==="prefixed"&&!this.shadowRoot&&(a=this._prefixSelectors(t));let s=document.createElement("style");return s.id=n,s.textContent=a,this.shadowRoot?this.shadowRoot.appendChild(s):document.head.appendChild(s),this.styleSheets.set(e,s),r.debug(`Estilo injetado: ${e}`),s}remove(e){let t=this.styleSheets.get(e);t&&t.parentNode&&(t.parentNode.removeChild(t),this.styleSheets.delete(e),r.debug(`Estilo removido: ${e}`))}injectBaseStyles(){this.inject("base",$())}clear(){this.styleSheets.forEach((e,t)=>this.remove(t)),r.debug("Todos os estilos foram removidos")}has(e){return this.styleSheets.has(e)}},u=new L;var z=class{constructor(){this.host=null,this.shadowRoot=null,this.contentWrapper=null,this._initialized=!1}async init(){if(this._initialized)return r.warn("Container j\xE1 inicializado"),this.contentWrapper;await j();let e=d(),t=l();return this.host=C("div",{id:`${t}-host`,style:{all:"initial",position:"fixed",top:"0",left:"0",width:"0",height:"0",overflow:"visible",zIndex:e.zIndexBase.toString(),pointerEvents:"none"}}),e.cssIsolation==="shadow-dom"&&(this.shadowRoot=this.host.attachShadow({mode:"open"}),u.setShadowRoot(this.shadowRoot)),this.contentWrapper=C("div",{id:`${t}-content`,className:`${t}-root`,style:{all:"initial",display:"block"}}),(this.shadowRoot||this.host).appendChild(this.contentWrapper),u.injectBaseStyles(),this._mountToDOM(e),this._initialized=!0,r.debug("Container inicializado"),this.contentWrapper}_mountToDOM(e){let{mountTarget:t,mountPosition:i}=e;if(t){let n=document.querySelector(t);if(n){n.appendChild(this.host);return}r.warn(`Target "${t}" n\xE3o encontrado, usando body`)}i==="body-start"?document.body.insertBefore(this.host,document.body.firstChild):document.body.appendChild(this.host)}getContentRoot(){if(!this._initialized)throw new Error("Container n\xE3o inicializado. Chame init() primeiro.");return this.contentWrapper}getShadowRoot(){return this.shadowRoot}isInitialized(){return this._initialized}destroy(){this._initialized&&(u.clear(),this.host&&this.host.parentNode&&this.host.parentNode.removeChild(this.host),this.host=null,this.shadowRoot=null,this.contentWrapper=null,this._initialized=!1,r.debug("Container destru\xEDdo"))}},f=new z;var O=class{constructor(){this.listeners=new Map}_prefixEvent(e){return`${l()}:${e}`}on(e,t){let i=this._prefixEvent(e);return this.listeners.has(i)||this.listeners.set(i,new Set),this.listeners.get(i).add(t),r.debug(`Listener registrado para evento: ${e}`),()=>this.off(e,t)}once(e,t){let i=(...n)=>{this.off(e,i),t(...n)};return this.on(e,i)}off(e,t){let i=this._prefixEvent(e),n=this.listeners.get(i);n&&(n.delete(t),n.size===0&&this.listeners.delete(i),r.debug(`Listener removido do evento: ${e}`))}emit(e,t){let i=this._prefixEvent(e),n=this.listeners.get(i);r.debug(`Evento emitido: ${e}`,t),n&&n.forEach(a=>{try{a(t)}catch(s){r.error(`Erro ao executar listener do evento ${e}:`,s)}})}clear(e){if(e){let t=this._prefixEvent(e);this.listeners.delete(t),r.debug(`Listeners limpos do evento: ${e}`)}else this.listeners.clear(),r.debug("Todos os listeners foram limpos")}},c=new O;var p={initialized:!1,destroyed:!1};async function b(o,...e){let i=d().hooks[o];if(typeof i=="function")try{await i(...e),r.debug(`Hook executado: ${o}`)}catch(n){r.error(`Erro no hook ${o}:`,n)}}async function R(o={}){if(p.initialized)return r.warn("Aplica\xE7\xE3o j\xE1 inicializada"),W();try{I(o);let e=d();return r.debug("Iniciando aplica\xE7\xE3o",e),await b("onBeforeInit"),await f.init(),c.emit("app:init",{config:e}),await b("onAfterInit"),p.initialized=!0,p.destroyed=!1,r.info("Aplica\xE7\xE3o inicializada com sucesso"),W()}catch(e){throw r.error("Falha na inicializa\xE7\xE3o:",e),await b("onError",e),e}}async function q(){if(!(!p.initialized||p.destroyed))try{await b("onBeforeDestroy"),c.emit("app:destroy"),c.clear(),f.destroy(),await b("onAfterDestroy"),p.initialized=!1,p.destroyed=!0,r.info("Aplica\xE7\xE3o destru\xEDda")}catch(o){r.error("Erro ao destruir aplica\xE7\xE3o:",o)}}function W(){return{isInitialized:()=>p.initialized,getContainer:()=>f.getContentRoot(),getShadowRoot:()=>f.getShadowRoot(),on:(o,e)=>c.on(o,e),off:(o,e)=>c.off(o,e),emit:(o,e)=>c.emit(o,e),getConfig:d,setConfig:I,destroy:q}}var h=class{constructor(e={}){this.id=M(this.constructor.name.toLowerCase()),this.props=e,this.state={},this.element=null,this.children=new Map,this._mounted=!1,this._eventCleanups=[]}static styles(){return""}render(){throw new Error("M\xE9todo render() deve ser implementado nas subclasses")}onMount(){}onUnmount(){}onUpdate(e){}setState(e){let t={...this.state};typeof e=="function"?this.state={...this.state,...e(this.state)}:this.state={...this.state,...e},this._mounted&&(this._rerender(),this.onUpdate(t))}_injectStyles(){let e=this.constructor.styles();if(e){let t=`component-${this.constructor.name.toLowerCase()}`;u.has(t)||u.inject(t,e)}}_rerender(){if(!this.element||!this.element.parentNode)return;let e=this.element.parentNode,t=this._createElement();e.replaceChild(t,this.element),this.element=t,this._bindEvents(),r.debug(`Componente re-renderizado: ${this.id}`)}_createElement(){let e=this.render();if(typeof e=="string"){let t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild||t}return e}_bindEvents(){}on(e,t){let i=c.on(e,t);this._eventCleanups.push(i)}emit(e,t){c.emit(e,t)}mount(e){return this._mounted?(r.warn(`Componente j\xE1 montado: ${this.id}`),this.element):(this._injectStyles(),this.element=this._createElement(),this.element.dataset.componentId=this.id,e.appendChild(this.element),this._mounted=!0,this._bindEvents(),this.onMount(),r.debug(`Componente montado: ${this.id}`),this.element)}unmount(){this._mounted&&(this.children.forEach(e=>e.unmount()),this.children.clear(),this._eventCleanups.forEach(e=>e()),this._eventCleanups=[],this.onUnmount(),T(this.element),this._mounted=!1,r.debug(`Componente desmontado: ${this.id}`))}addChild(e,t,i=null){return this.children.set(e,t),(i||this.element)&&t.mount(i||this.element),t}removeChild(e){let t=this.children.get(e);t&&(t.unmount(),this.children.delete(e))}getChild(e){return this.children.get(e)}};var te="citQs4acsN1StzOEDuvj",_=class extends h{constructor(e={}){super(e),this.targetSelector=e.targetSelector||"#OpportunityOwner",this.allowedLocationId=e.allowedLocationId||te,this.originalElement=null,this.state={isOpen:!1,users:e.users||[],selectedUser:null},this._handleToggle=this._handleToggle.bind(this),this._handleSelect=this._handleSelect.bind(this),this._handleClickOutside=this._handleClickOutside.bind(this)}static styles(){return`
      .user-dropdown {
        position: relative;
        display: inline-block;
        min-width: 200px;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        font-size: 14px;
      }

      .user-dropdown__trigger {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 8px 12px;
        background: #fff;
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        cursor: pointer;
        min-height: 38px;
        transition: border-color 0.15s ease;
      }

      .user-dropdown__trigger:hover {
        border-color: #d1d5db;
      }

      .user-dropdown__trigger--open {
        border-color: #3b82f6;
        box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
      }

      .user-dropdown__value {
        flex: 1;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        color: #374151;
      }

      .user-dropdown__placeholder {
        color: #9ca3af;
      }

      .user-dropdown__arrow {
        margin-left: 8px;
        width: 0;
        height: 0;
        border-left: 5px solid transparent;
        border-right: 5px solid transparent;
        border-top: 5px solid #6b7280;
        transition: transform 0.15s ease;
      }

      .user-dropdown__arrow--open {
        transform: rotate(180deg);
      }

      .user-dropdown__list {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        margin-top: 4px;
        background: #fff;
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
        max-height: 240px;
        overflow-y: auto;
        z-index: 1000;
        display: none;
      }

      .user-dropdown__list--open {
        display: block;
      }

      .user-dropdown__item {
        padding: 10px 12px;
        cursor: pointer;
        transition: background-color 0.1s ease;
        border-bottom: 1px solid #f3f4f6;
      }

      .user-dropdown__item:last-child {
        border-bottom: none;
      }

      .user-dropdown__item:hover {
        background-color: #f9fafb;
      }

      .user-dropdown__item--selected {
        background-color: #eff6ff;
      }

      .user-dropdown__item-name {
        font-weight: 500;
        color: #374151;
      }

      .user-dropdown__item-email {
        font-size: 12px;
        color: #9ca3af;
        margin-top: 2px;
      }

      .user-dropdown__empty {
        padding: 12px;
        text-align: center;
        color: #9ca3af;
      }
    `}setUsers(e){this.setState({users:e||[]})}render(){let{isOpen:e,users:t,selectedUser:i}=this.state,n=i?i.name:'<span class="user-dropdown__placeholder">Selecione um usu\xE1rio</span>',a=t.length>0?t.map(s=>`
          <div class="user-dropdown__item${i?.id===s.id?" user-dropdown__item--selected":""}"
               data-user-id="${s.id}">
            <div class="user-dropdown__item-name">${this._escapeHtml(s.name)}</div>
            <div class="user-dropdown__item-email">${this._escapeHtml(s.email)}</div>
          </div>
        `).join(""):'<div class="user-dropdown__empty">Nenhum usu\xE1rio dispon\xEDvel</div>';return`
      <div class="user-dropdown">
        <div class="user-dropdown__trigger${e?" user-dropdown__trigger--open":""}">
          <span class="user-dropdown__value">${n}</span>
          <span class="user-dropdown__arrow${e?" user-dropdown__arrow--open":""}"></span>
        </div>
        <div class="user-dropdown__list${e?" user-dropdown__list--open":""}">
          ${a}
        </div>
      </div>
    `}_escapeHtml(e){let t=document.createElement("div");return t.textContent=e||"",t.innerHTML}_getLocationIdFromUrl(){let t=window.location.pathname.match(/\/location\/([^\/]+)/);return t?t[1]:null}_isAllowedLocation(){return this._getLocationIdFromUrl()===this.allowedLocationId}_handleToggle(e){e.stopPropagation(),this.setState({isOpen:!this.state.isOpen})}_handleSelect(e){let t=e.target.closest(".user-dropdown__item");if(!t)return;let i=t.dataset.userId,n=this.state.users.find(a=>a.id===i);n&&(this.setState({selectedUser:n,isOpen:!1}),this.emit("user:selected",n))}_handleClickOutside(e){this.element&&!this.element.contains(e.target)&&this.state.isOpen&&this.setState({isOpen:!1})}_bindEvents(){if(!this.element)return;let e=this.element.querySelector(".user-dropdown__trigger"),t=this.element.querySelector(".user-dropdown__list");e&&e.addEventListener("click",this._handleToggle),t&&t.addEventListener("click",this._handleSelect),document.addEventListener("click",this._handleClickOutside)}_unbindEvents(){document.removeEventListener("click",this._handleClickOutside)}async mountReplacing(){try{if(!this._isAllowedLocation()){let e=this._getLocationIdFromUrl();return r.debug(`UserDropdown n\xE3o exibido: locationId atual (${e}) diferente do permitido (${this.allowedLocationId})`),null}return this.originalElement=await S(this.targetSelector,{timeout:1e4}),this.originalElement?(this.originalElement.style.display="none",this._injectStyles(),this.element=this._createElement(),this.element.dataset.componentId=this.id,this.originalElement.parentNode.insertBefore(this.element,this.originalElement.nextSibling),this._mounted=!0,this._bindEvents(),this.onMount(),r.debug(`UserDropdown montado substituindo: ${this.targetSelector}`),this.element):(r.error(`Elemento n\xE3o encontrado: ${this.targetSelector}`),null)}catch(e){return r.error(`Erro ao montar UserDropdown: ${e.message}`),null}}onUnmount(){this._unbindEvents(),this.originalElement&&(this.originalElement.style.display="",r.debug("Elemento original restaurado"))}};var k={baseUrl:"https://services.leadconnectorhq.com",token:"pit-301590c6-a6cb-47d5-a7f4-bc5c4f5c22d4",version:"2021-07-28"};function oe(){return{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${k.token}`,Version:k.version}}async function H(o){let e=`${k.baseUrl}/users/?locationId=${o}`,t=await fetch(e,{method:"GET",headers:oe()});if(!t.ok)throw new Error(`Erro ao buscar usu\xE1rios: ${t.status}`);return(await t.json()).users||[]}function P(){let e=window.location.pathname.match(/\/location\/([^\/]+)/);return e?e[1]:null}var U="citQs4acsN1StzOEDuvj",g=null;async function y(o={}){try{let e={debug:!0,namespace:"ui-injector",...o};r.info("Iniciando aplica\xE7\xE3o Switch User...");let t=P();if(t!==U)return r.debug(`Location n\xE3o permitida: ${t}`),null;r.debug(`Location permitida: ${t}`),await R(e),r.debug("Buscando usu\xE1rios da API...");let i=await H(U);return r.info(`${i.length} usu\xE1rios carregados`),g=new _({users:i,targetSelector:"#OpportunityOwner",allowedLocationId:U}),g.on("user:selected",n=>{r.info(`Usu\xE1rio selecionado: ${n.name}`)}),await g.mountReplacing(),r.info("Aplica\xE7\xE3o iniciada com sucesso!"),{dropdown:g,users:i,getSelectedUser:()=>g?.state?.selectedUser}}catch(e){throw r.error(`Erro ao iniciar aplica\xE7\xE3o: ${e.message}`),e}}function A(){return g}typeof window<"u"&&(window.SwitchUser={start:y,getDropdown:A},document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>y()):y());var ie={startApp:y,getDropdown:A};return X(re);})();
