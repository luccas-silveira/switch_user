var SwitchUser=(()=>{var E=Object.defineProperty;var P=Object.getOwnPropertyDescriptor;var G=Object.getOwnPropertyNames;var V=Object.prototype.hasOwnProperty;var Q=(o,e)=>{for(var t in e)E(o,t,{get:e[t],enumerable:!0})},Z=(o,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of G(e))!V.call(o,r)&&r!==t&&E(o,r,{get:()=>e[r],enumerable:!(i=P(e,r))||i.enumerable});return o};var J=o=>Z(E({},"__esModule",{value:!0}),o);var oe={};Q(oe,{default:()=>te,getDropdown:()=>A,startApp:()=>y});var K={namespace:"ui-injector",version:"1.0.0",debug:!1,cssIsolation:"shadow-dom",mountTarget:null,mountPosition:"body-end",zIndexBase:999e3,domTimeout:5e3,retryInterval:100,maxRetries:50,observeMutations:!0,hooks:{onBeforeInit:null,onAfterInit:null,onBeforeMount:null,onAfterMount:null,onBeforeDestroy:null,onAfterDestroy:null,onError:null}},x={...K};function l(){return{...x}}function _(o){return x={...x,...o,hooks:{...x.hooks,...o.hooks||{}}},l()}function d(){return x.namespace}function I(o,e={}){let t=l(),{timeout:i=t.domTimeout,interval:r=t.retryInterval,parent:a=document}=e;return new Promise((s,g)=>{let v=a.querySelector(o);if(v){s(v);return}let H=Date.now(),N=setInterval(()=>{let U=a.querySelector(o);if(U){clearInterval(N),s(U);return}Date.now()-H>=i&&(clearInterval(N),g(new Error(`Timeout: elemento "${o}" n\xE3o encontrado`)))},r)})}function D(){return new Promise(o=>{document.readyState==="loading"?document.addEventListener("DOMContentLoaded",o,{once:!0}):o()})}function S(o,e={},t=[]){let i=document.createElement(o);return Object.entries(e).forEach(([a,s])=>{if(a==="className")i.className=s;else if(a==="style"&&typeof s=="object")Object.assign(i.style,s);else if(a.startsWith("on")&&typeof s=="function"){let g=a.slice(2).toLowerCase();i.addEventListener(g,s)}else a==="dataset"&&typeof s=="object"?Object.entries(s).forEach(([g,v])=>{i.dataset[g]=v}):i.setAttribute(a,s)}),(Array.isArray(t)?t:[t]).forEach(a=>{typeof a=="string"?i.appendChild(document.createTextNode(a)):a instanceof Node&&i.appendChild(a)}),i}var M=`
  :host {
    /* Cores prim\xE1rias */
    --ui-color-primary: #3b82f6;
    --ui-color-primary-hover: #2563eb;
    --ui-color-primary-light: #dbeafe;

    /* Cores de texto */
    --ui-color-text: #1f2937;
    --ui-color-text-muted: #6b7280;
    --ui-color-text-light: #9ca3af;

    /* Cores de fundo */
    --ui-color-bg: #ffffff;
    --ui-color-bg-secondary: #f9fafb;
    --ui-color-bg-tertiary: #f3f4f6;

    /* Cores de borda */
    --ui-color-border: #e5e7eb;
    --ui-color-border-dark: #d1d5db;

    /* Cores de status */
    --ui-color-success: #10b981;
    --ui-color-warning: #f59e0b;
    --ui-color-error: #ef4444;
    --ui-color-info: #3b82f6;

    /* Sombras */
    --ui-shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    --ui-shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    --ui-shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);

    /* Espa\xE7amento */
    --ui-spacing-xs: 4px;
    --ui-spacing-sm: 8px;
    --ui-spacing-md: 16px;
    --ui-spacing-lg: 24px;
    --ui-spacing-xl: 32px;

    /* Tipografia */
    --ui-font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    --ui-font-size-xs: 12px;
    --ui-font-size-sm: 14px;
    --ui-font-size-md: 16px;
    --ui-font-size-lg: 18px;
    --ui-font-size-xl: 20px;

    /* Bordas */
    --ui-radius-sm: 4px;
    --ui-radius-md: 6px;
    --ui-radius-lg: 8px;
    --ui-radius-full: 9999px;

    /* Transi\xE7\xF5es */
    --ui-transition-fast: 150ms ease;
    --ui-transition-normal: 250ms ease;
    --ui-transition-slow: 350ms ease;

    /* Z-index */
    --ui-z-dropdown: 100;
    --ui-z-modal: 200;
    --ui-z-tooltip: 300;
    --ui-z-toast: 400;
  }
`,j=`
  *, *::before, *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  :host {
    font-family: var(--ui-font-family);
    font-size: var(--ui-font-size-md);
    color: var(--ui-color-text);
    line-height: 1.5;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  button, input, select, textarea {
    font-family: inherit;
    font-size: inherit;
  }

  button {
    cursor: pointer;
    border: none;
    background: none;
  }

  a {
    color: inherit;
    text-decoration: none;
  }

  img, svg {
    display: block;
    max-width: 100%;
  }

  [hidden] {
    display: none !important;
  }
`;function C(){return`${M}
${j}`}function h(o,e){let t=d(),i=new Date().toISOString().split("T")[1].split(".")[0];return`[${t}][${i}][${o}] ${e}`}var X={debug(o,...e){l().debug&&console.log(h("DEBUG",o),...e)},info(o,...e){console.info(h("INFO",o),...e)},warn(o,...e){console.warn(h("WARN",o),...e)},error(o,...e){console.error(h("ERROR",o),...e);let t=l();if(t.hooks.onError)try{t.hooks.onError(new Error(o),e)}catch(i){console.error(h("ERROR","Erro no hook onError"),i)}},group(o,e){if(l().debug){console.groupCollapsed(h("GROUP",o));try{e()}finally{console.groupEnd()}}}},n=X;var $=class{constructor(){this.styleSheets=new Map,this.shadowRoot=null}setShadowRoot(e){this.shadowRoot=e}_getStyleId(e){return`${d()}-style-${e}`}_prefixSelectors(e){let t=d();return e.replace(/([^\r\n,{}]+)(,(?=[^}]*{)|\s*{)/g,(i,r,a)=>{let s=r.trim();return s.startsWith("@")||s.startsWith(":root")||s.startsWith(":host")?i:`.${t} ${s}${a}`})}inject(e,t){let i=l(),r=this._getStyleId(e);this.remove(e);let a=t;i.cssIsolation==="prefixed"&&!this.shadowRoot&&(a=this._prefixSelectors(t));let s=document.createElement("style");return s.id=r,s.textContent=a,this.shadowRoot?this.shadowRoot.appendChild(s):document.head.appendChild(s),this.styleSheets.set(e,s),n.debug(`Estilo injetado: ${e}`),s}remove(e){let t=this.styleSheets.get(e);t&&t.parentNode&&(t.parentNode.removeChild(t),this.styleSheets.delete(e),n.debug(`Estilo removido: ${e}`))}injectBaseStyles(){this.inject("base",C())}clear(){this.styleSheets.forEach((e,t)=>this.remove(t)),n.debug("Todos os estilos foram removidos")}has(e){return this.styleSheets.has(e)}},p=new $;var L=class{constructor(){this.host=null,this.shadowRoot=null,this.contentWrapper=null,this._initialized=!1}async init(){if(this._initialized)return n.warn("Container j\xE1 inicializado"),this.contentWrapper;await D();let e=l(),t=d();return this.host=S("div",{id:`${t}-host`,style:{all:"initial",position:"fixed",top:"0",left:"0",width:"0",height:"0",overflow:"visible",zIndex:e.zIndexBase.toString(),pointerEvents:"none"}}),e.cssIsolation==="shadow-dom"&&(this.shadowRoot=this.host.attachShadow({mode:"open"}),p.setShadowRoot(this.shadowRoot)),this.contentWrapper=S("div",{id:`${t}-content`,className:`${t}-root`,style:{all:"initial",display:"block"}}),(this.shadowRoot||this.host).appendChild(this.contentWrapper),p.injectBaseStyles(),this._mountToDOM(e),this._initialized=!0,n.debug("Container inicializado"),this.contentWrapper}_mountToDOM(e){let{mountTarget:t,mountPosition:i}=e;if(t){let r=document.querySelector(t);if(r){r.appendChild(this.host);return}n.warn(`Target "${t}" n\xE3o encontrado, usando body`)}i==="body-start"?document.body.insertBefore(this.host,document.body.firstChild):document.body.appendChild(this.host)}getContentRoot(){if(!this._initialized)throw new Error("Container n\xE3o inicializado. Chame init() primeiro.");return this.contentWrapper}getShadowRoot(){return this.shadowRoot}isInitialized(){return this._initialized}destroy(){this._initialized&&(p.clear(),this.host&&this.host.parentNode&&this.host.parentNode.removeChild(this.host),this.host=null,this.shadowRoot=null,this.contentWrapper=null,this._initialized=!1,n.debug("Container destru\xEDdo"))}},m=new L;var z=class{constructor(){this.listeners=new Map}_prefixEvent(e){return`${d()}:${e}`}on(e,t){let i=this._prefixEvent(e);return this.listeners.has(i)||this.listeners.set(i,new Set),this.listeners.get(i).add(t),n.debug(`Listener registrado para evento: ${e}`),()=>this.off(e,t)}once(e,t){let i=(...r)=>{this.off(e,i),t(...r)};return this.on(e,i)}off(e,t){let i=this._prefixEvent(e),r=this.listeners.get(i);r&&(r.delete(t),r.size===0&&this.listeners.delete(i),n.debug(`Listener removido do evento: ${e}`))}emit(e,t){let i=this._prefixEvent(e),r=this.listeners.get(i);n.debug(`Evento emitido: ${e}`,t),r&&r.forEach(a=>{try{a(t)}catch(s){n.error(`Erro ao executar listener do evento ${e}:`,s)}})}clear(e){if(e){let t=this._prefixEvent(e);this.listeners.delete(t),n.debug(`Listeners limpos do evento: ${e}`)}else this.listeners.clear(),n.debug("Todos os listeners foram limpos")}},c=new z;var u={initialized:!1,destroyed:!1};async function b(o,...e){let i=l().hooks[o];if(typeof i=="function")try{await i(...e),n.debug(`Hook executado: ${o}`)}catch(r){n.error(`Erro no hook ${o}:`,r)}}async function O(o={}){if(u.initialized)return n.warn("Aplica\xE7\xE3o j\xE1 inicializada"),T();try{_(o);let e=l();return n.debug("Iniciando aplica\xE7\xE3o",e),await b("onBeforeInit"),await m.init(),c.emit("app:init",{config:e}),await b("onAfterInit"),u.initialized=!0,u.destroyed=!1,n.info("Aplica\xE7\xE3o inicializada com sucesso"),T()}catch(e){throw n.error("Falha na inicializa\xE7\xE3o:",e),await b("onError",e),e}}async function B(){if(!(!u.initialized||u.destroyed))try{await b("onBeforeDestroy"),c.emit("app:destroy"),c.clear(),m.destroy(),await b("onAfterDestroy"),u.initialized=!1,u.destroyed=!0,n.info("Aplica\xE7\xE3o destru\xEDda")}catch(o){n.error("Erro ao destruir aplica\xE7\xE3o:",o)}}function T(){return{isInitialized:()=>u.initialized,getContainer:()=>m.getContentRoot(),getShadowRoot:()=>m.getShadowRoot(),on:(o,e)=>c.on(o,e),off:(o,e)=>c.off(o,e),emit:(o,e)=>c.emit(o,e),getConfig:l,setConfig:_,destroy:B}}var Y="citQs4acsN1StzOEDuvj",w=class{constructor(e={}){this.id="user-dropdown-"+Math.random().toString(36).substring(2,9),this.targetSelector=e.targetSelector||"#OpportunityOwner",this.allowedLocationId=e.allowedLocationId||Y,this.originalElement=null,this.element=null,this._mounted=!1,this.state={isOpen:!1,users:e.users||[],selectedUser:null},this._eventListeners=[],this._handleToggle=this._handleToggle.bind(this),this._handleSelect=this._handleSelect.bind(this),this._handleClickOutside=this._handleClickOutside.bind(this)}on(e,t){this._eventListeners.push({event:e,callback:t})}emit(e,t){this._eventListeners.filter(i=>i.event===e).forEach(i=>i.callback(t))}setState(e){this.state={...this.state,...e},this._mounted&&this._rerender()}setUsers(e){this.setState({users:e||[]})}_getStyles(){return`
      <style>
        .ud-container {
          position: relative;
          display: inline-block;
          width: 100%;
          font-family: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
          font-size: 14px;
        }

        .ud-trigger {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 9px 12px;
          background: #fff;
          border: 1px solid #e2e8f0;
          border-radius: 8px;
          cursor: pointer;
          min-height: 40px;
          transition: all 0.15s ease;
          width: 100%;
          box-sizing: border-box;
        }

        .ud-trigger:hover {
          border-color: #cbd5e1;
        }

        .ud-trigger.open {
          border-color: #3b82f6;
          box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .ud-value {
          flex: 1;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
          color: #1e293b;
        }

        .ud-placeholder {
          color: #94a3b8;
        }

        .ud-arrow {
          margin-left: 8px;
          width: 20px;
          height: 20px;
          display: flex;
          align-items: center;
          justify-content: center;
          color: #64748b;
          transition: transform 0.2s ease;
        }

        .ud-arrow.open {
          transform: rotate(180deg);
        }

        .ud-arrow svg {
          width: 16px;
          height: 16px;
        }

        .ud-list {
          position: absolute;
          top: calc(100% + 4px);
          left: 0;
          right: 0;
          background: #fff;
          border: 1px solid #e2e8f0;
          border-radius: 8px;
          box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
          max-height: 280px;
          overflow-y: auto;
          z-index: 99999;
          display: none;
        }

        .ud-list.open {
          display: block;
        }

        .ud-item {
          padding: 10px 14px;
          cursor: pointer;
          transition: background-color 0.1s ease;
          border-bottom: 1px solid #f1f5f9;
        }

        .ud-item:last-child {
          border-bottom: none;
        }

        .ud-item:hover {
          background-color: #f8fafc;
        }

        .ud-item.selected {
          background-color: #eff6ff;
        }

        .ud-item-name {
          font-weight: 500;
          color: #1e293b;
          font-size: 14px;
        }

        .ud-empty {
          padding: 16px;
          text-align: center;
          color: #94a3b8;
        }
      </style>
    `}_getArrowIcon(){return`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd" />
    </svg>`}_escapeHtml(e){let t=document.createElement("div");return t.textContent=e||"",t.innerHTML}_render(){let{isOpen:e,users:t,selectedUser:i}=this.state,r=i?`<span class="ud-value">${this._escapeHtml(i.name)}</span>`:'<span class="ud-value ud-placeholder">Selecione um usu\xE1rio</span>',a=t.length>0?t.map(s=>`
          <div class="ud-item${i?.id===s.id?" selected":""}" data-user-id="${s.id}">
            <div class="ud-item-name">${this._escapeHtml(s.name)}</div>
          </div>
        `).join(""):'<div class="ud-empty">Nenhum usu\xE1rio dispon\xEDvel</div>';return`
      ${this._getStyles()}
      <div class="ud-container" data-component-id="${this.id}">
        <div class="ud-trigger${e?" open":""}">
          ${r}
          <span class="ud-arrow${e?" open":""}">${this._getArrowIcon()}</span>
        </div>
        <div class="ud-list${e?" open":""}">
          ${a}
        </div>
      </div>
    `}_createElement(){let e=document.createElement("div");return e.innerHTML=this._render(),e}_rerender(){if(!this.element||!this.element.parentNode)return;let e=this.element.parentNode,t=this._createElement();e.replaceChild(t,this.element),this.element=t,this._bindEvents(),n.debug(`Componente re-renderizado: ${this.id}`)}_getLocationIdFromUrl(){let t=window.location.pathname.match(/\/location\/([^\/]+)/);return t?t[1]:null}_isAllowedLocation(){return this._getLocationIdFromUrl()===this.allowedLocationId}_handleToggle(e){e.stopPropagation(),e.preventDefault(),this.setState({isOpen:!this.state.isOpen})}_handleSelect(e){let t=e.target.closest(".ud-item");if(!t)return;let i=t.dataset.userId,r=this.state.users.find(a=>a.id===i);r&&(this.setState({selectedUser:r,isOpen:!1}),this.emit("user:selected",r),n.debug(`Usu\xE1rio selecionado: ${r.name}`))}_handleClickOutside(e){this.element&&!this.element.contains(e.target)&&this.state.isOpen&&this.setState({isOpen:!1})}_bindEvents(){if(!this.element)return;let e=this.element.querySelector(".ud-trigger"),t=this.element.querySelector(".ud-list");e&&e.addEventListener("click",this._handleToggle),t&&t.addEventListener("click",this._handleSelect),document.removeEventListener("click",this._handleClickOutside),document.addEventListener("click",this._handleClickOutside)}_unbindEvents(){document.removeEventListener("click",this._handleClickOutside)}async mountReplacing(){try{if(!this._isAllowedLocation()){let e=this._getLocationIdFromUrl();return n.debug(`UserDropdown n\xE3o exibido: locationId atual (${e}) diferente do permitido (${this.allowedLocationId})`),null}return this.originalElement=await I(this.targetSelector,{timeout:1e4}),this.originalElement?(this.originalElement.style.display="none",this.element=this._createElement(),this.originalElement.parentNode.insertBefore(this.element,this.originalElement.nextSibling),this._mounted=!0,this._bindEvents(),n.debug(`UserDropdown montado substituindo: ${this.targetSelector}`),this.element):(n.error(`Elemento n\xE3o encontrado: ${this.targetSelector}`),null)}catch(e){return n.error(`Erro ao montar UserDropdown: ${e.message}`),null}}unmount(){this._unbindEvents(),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.originalElement&&(this.originalElement.style.display="",n.debug("Elemento original restaurado")),this._mounted=!1}};var R={baseUrl:"https://services.leadconnectorhq.com",token:"pit-301590c6-a6cb-47d5-a7f4-bc5c4f5c22d4",version:"2021-07-28"};function ee(){return{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${R.token}`,Version:R.version}}async function W(o){let e=`${R.baseUrl}/users/?locationId=${o}`,t=await fetch(e,{method:"GET",headers:ee()});if(!t.ok)throw new Error(`Erro ao buscar usu\xE1rios: ${t.status}`);return(await t.json()).users||[]}function q(){let e=window.location.pathname.match(/\/location\/([^\/]+)/);return e?e[1]:null}var k="citQs4acsN1StzOEDuvj",f=null;async function y(o={}){try{let e={debug:!0,namespace:"ui-injector",...o};n.info("Iniciando aplica\xE7\xE3o Switch User...");let t=q();if(t!==k)return n.debug(`Location n\xE3o permitida: ${t}`),null;n.debug(`Location permitida: ${t}`),await O(e),n.debug("Buscando usu\xE1rios da API...");let i=await W(k);return n.info(`${i.length} usu\xE1rios carregados`),f=new w({users:i,targetSelector:"#OpportunityOwner",allowedLocationId:k}),f.on("user:selected",r=>{n.info(`Usu\xE1rio selecionado: ${r.name}`)}),await f.mountReplacing(),n.info("Aplica\xE7\xE3o iniciada com sucesso!"),{dropdown:f,users:i,getSelectedUser:()=>f?.state?.selectedUser}}catch(e){throw n.error(`Erro ao iniciar aplica\xE7\xE3o: ${e.message}`),e}}function A(){return f}typeof window<"u"&&(window.SwitchUser={start:y,getDropdown:A},document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>y()):y());var te={startApp:y,getDropdown:A};return J(oe);})();
