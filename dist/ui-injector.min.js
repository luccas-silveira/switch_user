var UIInjector=(()=>{var O=Object.defineProperty;var de=Object.getOwnPropertyDescriptor;var ce=Object.getOwnPropertyNames;var ue=Object.prototype.hasOwnProperty;var he=(o,e)=>{for(var t in e)O(o,t,{get:e[t],enumerable:!0})},pe=(o,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of ce(e))!ue.call(o,i)&&i!==t&&O(o,i,{get:()=>e[i],enumerable:!(n=de(e,i))||n.enumerable});return o};var me=o=>pe(O({},"__esModule",{value:!0}),o);var Le={};he(Le,{default:()=>Ce});var fe={namespace:"ui-injector",version:"1.0.0",debug:!1,cssIsolation:"shadow-dom",mountTarget:null,mountPosition:"body-end",zIndexBase:999e3,domTimeout:5e3,retryInterval:100,maxRetries:50,observeMutations:!0,hooks:{onBeforeInit:null,onAfterInit:null,onBeforeMount:null,onAfterMount:null,onBeforeDestroy:null,onAfterDestroy:null,onError:null}},y={...fe};function l(){return{...y}}function R(o){return y={...y,...o,hooks:{...y.hooks,...o.hooks||{}}},l()}function c(){return y.namespace}function z(o,e={}){let t=l(),{timeout:n=t.domTimeout,interval:i=t.retryInterval,parent:a=document}=e;return new Promise((s,w)=>{let _=a.querySelector(o);if(_){s(_);return}let le=Date.now(),V=setInterval(()=>{let Q=a.querySelector(o);if(Q){clearInterval(V),s(Q);return}Date.now()-le>=n&&(clearInterval(V),w(new Error(`Timeout: elemento "${o}" n\xE3o encontrado`)))},i)})}function Y(){return new Promise(o=>{document.readyState==="loading"?document.addEventListener("DOMContentLoaded",o,{once:!0}):o()})}function k(o,e={},t=[]){let n=document.createElement(o);return Object.entries(e).forEach(([a,s])=>{if(a==="className")n.className=s;else if(a==="style"&&typeof s=="object")Object.assign(n.style,s);else if(a.startsWith("on")&&typeof s=="function"){let w=a.slice(2).toLowerCase();n.addEventListener(w,s)}else a==="dataset"&&typeof s=="object"?Object.entries(s).forEach(([w,_])=>{n.dataset[w]=_}):n.setAttribute(a,s)}),(Array.isArray(t)?t:[t]).forEach(a=>{typeof a=="string"?n.appendChild(document.createTextNode(a)):a instanceof Node&&n.appendChild(a)}),n}function p(o,e){let t=c(),n=new Date().toISOString().split("T")[1].split(".")[0];return`[${t}][${n}][${o}] ${e}`}var d={debug(o,...e){l().debug&&console.log(p("DEBUG",o),...e)},info(o,...e){console.info(p("INFO",o),...e)},warn(o,...e){console.warn(p("WARN",o),...e)},error(o,...e){console.error(p("ERROR",o),...e);let t=l();if(t.hooks.onError)try{t.hooks.onError(new Error(o),e)}catch(n){console.error(p("ERROR","Erro no hook onError"),n)}},group(o,e){if(l().debug){console.groupCollapsed(p("GROUP",o));try{e()}finally{console.groupEnd()}}}},r=d;var A=class{constructor(){this.listeners=new Map}_prefixEvent(e){return`${c()}:${e}`}on(e,t){let n=this._prefixEvent(e);return this.listeners.has(n)||this.listeners.set(n,new Set),this.listeners.get(n).add(t),r.debug(`Listener registrado para evento: ${e}`),()=>this.off(e,t)}once(e,t){let n=(...i)=>{this.off(e,n),t(...i)};return this.on(e,n)}off(e,t){let n=this._prefixEvent(e),i=this.listeners.get(n);i&&(i.delete(t),i.size===0&&this.listeners.delete(n),r.debug(`Listener removido do evento: ${e}`))}emit(e,t){let n=this._prefixEvent(e),i=this.listeners.get(n);r.debug(`Evento emitido: ${e}`,t),i&&i.forEach(a=>{try{a(t)}catch(s){r.error(`Erro ao executar listener do evento ${e}:`,s)}})}clear(e){if(e){let t=this._prefixEvent(e);this.listeners.delete(t),r.debug(`Listeners limpos do evento: ${e}`)}else this.listeners.clear(),r.debug("Todos os listeners foram limpos")}},u=new A;var J=`
  :host {
    /* Cores prim\xE1rias */
    --ui-color-primary: #3b82f6;
    --ui-color-primary-hover: #2563eb;
    --ui-color-primary-light: #dbeafe;

    /* Cores de texto */
    --ui-color-text: #1f2937;
    --ui-color-text-muted: #6b7280;
    --ui-color-text-light: #9ca3af;

    /* Cores de fundo */
    --ui-color-bg: #ffffff;
    --ui-color-bg-secondary: #f9fafb;
    --ui-color-bg-tertiary: #f3f4f6;

    /* Cores de borda */
    --ui-color-border: #e5e7eb;
    --ui-color-border-dark: #d1d5db;

    /* Cores de status */
    --ui-color-success: #10b981;
    --ui-color-warning: #f59e0b;
    --ui-color-error: #ef4444;
    --ui-color-info: #3b82f6;

    /* Sombras */
    --ui-shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    --ui-shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    --ui-shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);

    /* Espa\xE7amento */
    --ui-spacing-xs: 4px;
    --ui-spacing-sm: 8px;
    --ui-spacing-md: 16px;
    --ui-spacing-lg: 24px;
    --ui-spacing-xl: 32px;

    /* Tipografia */
    --ui-font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    --ui-font-size-xs: 12px;
    --ui-font-size-sm: 14px;
    --ui-font-size-md: 16px;
    --ui-font-size-lg: 18px;
    --ui-font-size-xl: 20px;

    /* Bordas */
    --ui-radius-sm: 4px;
    --ui-radius-md: 6px;
    --ui-radius-lg: 8px;
    --ui-radius-full: 9999px;

    /* Transi\xE7\xF5es */
    --ui-transition-fast: 150ms ease;
    --ui-transition-normal: 250ms ease;
    --ui-transition-slow: 350ms ease;

    /* Z-index */
    --ui-z-dropdown: 100;
    --ui-z-modal: 200;
    --ui-z-tooltip: 300;
    --ui-z-toast: 400;
  }
`,K=`
  *, *::before, *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  :host {
    font-family: var(--ui-font-family);
    font-size: var(--ui-font-size-md);
    color: var(--ui-color-text);
    line-height: 1.5;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  button, input, select, textarea {
    font-family: inherit;
    font-size: inherit;
  }

  button {
    cursor: pointer;
    border: none;
    background: none;
  }

  a {
    color: inherit;
    text-decoration: none;
  }

  img, svg {
    display: block;
    max-width: 100%;
  }

  [hidden] {
    display: none !important;
  }
`;function T(){return`${J}
${K}`}var j=class{constructor(){this.styleSheets=new Map,this.shadowRoot=null}setShadowRoot(e){this.shadowRoot=e}_getStyleId(e){return`${c()}-style-${e}`}_prefixSelectors(e){let t=c();return e.replace(/([^\r\n,{}]+)(,(?=[^}]*{)|\s*{)/g,(n,i,a)=>{let s=i.trim();return s.startsWith("@")||s.startsWith(":root")||s.startsWith(":host")?n:`.${t} ${s}${a}`})}inject(e,t){let n=l(),i=this._getStyleId(e);this.remove(e);let a=t;n.cssIsolation==="prefixed"&&!this.shadowRoot&&(a=this._prefixSelectors(t));let s=document.createElement("style");return s.id=i,s.textContent=a,this.shadowRoot?this.shadowRoot.appendChild(s):document.head.appendChild(s),this.styleSheets.set(e,s),r.debug(`Estilo injetado: ${e}`),s}remove(e){let t=this.styleSheets.get(e);t&&t.parentNode&&(t.parentNode.removeChild(t),this.styleSheets.delete(e),r.debug(`Estilo removido: ${e}`))}injectBaseStyles(){this.inject("base",T())}clear(){this.styleSheets.forEach((e,t)=>this.remove(t)),r.debug("Todos os estilos foram removidos")}has(e){return this.styleSheets.has(e)}},m=new j;var ge="citQs4acsN1StzOEDuvj",x=class{constructor(e={}){this.id="user-dropdown-"+Math.random().toString(36).substring(2,9),this.targetSelector=e.targetSelector||"#OpportunityOwner",this.allowedLocationId=e.allowedLocationId||ge,this.originalElement=null,this.element=null,this._mounted=!1,this.state={isOpen:!1,users:e.users||[],selectedUser:null},this._eventListeners=[],this._handleToggle=this._handleToggle.bind(this),this._handleSelect=this._handleSelect.bind(this),this._handleClickOutside=this._handleClickOutside.bind(this)}on(e,t){this._eventListeners.push({event:e,callback:t})}emit(e,t){this._eventListeners.filter(n=>n.event===e).forEach(n=>n.callback(t))}setState(e){this.state={...this.state,...e},this._mounted&&this._rerender()}setUsers(e){this.setState({users:e||[]})}_getStyles(){return`
      <style>
        .ud-container {
          position: relative;
          display: inline-block;
          width: 100%;
          font-family: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
          font-size: 14px;
        }

        .ud-trigger {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 9px 12px;
          background: #fff;
          border: 1px solid #e2e8f0;
          border-radius: 8px;
          cursor: pointer;
          min-height: 40px;
          transition: all 0.15s ease;
          width: 100%;
          box-sizing: border-box;
        }

        .ud-trigger:hover {
          border-color: #cbd5e1;
        }

        .ud-trigger.open {
          border-color: #3b82f6;
          box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .ud-value {
          flex: 1;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
          color: #1e293b;
        }

        .ud-placeholder {
          color: #94a3b8;
        }

        .ud-arrow {
          margin-left: 8px;
          width: 20px;
          height: 20px;
          display: flex;
          align-items: center;
          justify-content: center;
          color: #64748b;
          transition: transform 0.2s ease;
        }

        .ud-arrow.open {
          transform: rotate(180deg);
        }

        .ud-arrow svg {
          width: 16px;
          height: 16px;
        }

        .ud-list {
          position: absolute;
          top: calc(100% + 4px);
          left: 0;
          right: 0;
          background: #fff;
          border: 1px solid #e2e8f0;
          border-radius: 8px;
          box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
          max-height: 280px;
          overflow-y: auto;
          z-index: 99999;
          display: none;
        }

        .ud-list.open {
          display: block;
        }

        .ud-item {
          padding: 10px 14px;
          cursor: pointer;
          transition: background-color 0.1s ease;
          border-bottom: 1px solid #f1f5f9;
        }

        .ud-item:last-child {
          border-bottom: none;
        }

        .ud-item:hover {
          background-color: #f8fafc;
        }

        .ud-item.selected {
          background-color: #eff6ff;
        }

        .ud-item-name {
          font-weight: 500;
          color: #1e293b;
          font-size: 14px;
        }

        .ud-empty {
          padding: 16px;
          text-align: center;
          color: #94a3b8;
        }
      </style>
    `}_getArrowIcon(){return`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd" />
    </svg>`}_escapeHtml(e){let t=document.createElement("div");return t.textContent=e||"",t.innerHTML}_render(){let{isOpen:e,users:t,selectedUser:n}=this.state,i=n?`<span class="ud-value">${this._escapeHtml(n.name)}</span>`:'<span class="ud-value ud-placeholder">Selecione um usu\xE1rio</span>',a=t.length>0?t.map(s=>`
          <div class="ud-item${n?.id===s.id?" selected":""}" data-user-id="${s.id}">
            <div class="ud-item-name">${this._escapeHtml(s.name)}</div>
          </div>
        `).join(""):'<div class="ud-empty">Nenhum usu\xE1rio dispon\xEDvel</div>';return`
      ${this._getStyles()}
      <div class="ud-container" data-component-id="${this.id}">
        <div class="ud-trigger${e?" open":""}">
          ${i}
          <span class="ud-arrow${e?" open":""}">${this._getArrowIcon()}</span>
        </div>
        <div class="ud-list${e?" open":""}">
          ${a}
        </div>
      </div>
    `}_createElement(){let e=document.createElement("div");return e.innerHTML=this._render(),e}_rerender(){if(!this.element||!this.element.parentNode)return;let e=this.element.parentNode,t=this._createElement();e.replaceChild(t,this.element),this.element=t,this._bindEvents(),r.debug(`Componente re-renderizado: ${this.id}`)}_getLocationIdFromUrl(){let t=window.location.pathname.match(/\/location\/([^\/]+)/);return t?t[1]:null}_isAllowedLocation(){return this._getLocationIdFromUrl()===this.allowedLocationId}_handleToggle(e){e.stopPropagation(),e.preventDefault(),this.setState({isOpen:!this.state.isOpen})}_handleSelect(e){let t=e.target.closest(".ud-item");if(!t)return;let n=t.dataset.userId,i=this.state.users.find(a=>a.id===n);i&&(this.setState({selectedUser:i,isOpen:!1}),this.emit("user:selected",i),r.debug(`Usu\xE1rio selecionado: ${i.name}`))}_handleClickOutside(e){this.element&&!this.element.contains(e.target)&&this.state.isOpen&&this.setState({isOpen:!1})}_bindEvents(){if(!this.element)return;let e=this.element.querySelector(".ud-trigger"),t=this.element.querySelector(".ud-list");e&&e.addEventListener("click",this._handleToggle),t&&t.addEventListener("click",this._handleSelect),document.removeEventListener("click",this._handleClickOutside),document.addEventListener("click",this._handleClickOutside)}_unbindEvents(){document.removeEventListener("click",this._handleClickOutside)}async mountReplacing(){try{if(!this._isAllowedLocation()){let e=this._getLocationIdFromUrl();return r.debug(`UserDropdown n\xE3o exibido: locationId atual (${e}) diferente do permitido (${this.allowedLocationId})`),null}return this.originalElement=await z(this.targetSelector,{timeout:1e4}),this.originalElement?(this.originalElement.style.display="none",this.element=this._createElement(),this.originalElement.parentNode.insertBefore(this.element,this.originalElement.nextSibling),this._mounted=!0,this._bindEvents(),r.debug(`UserDropdown montado substituindo: ${this.targetSelector}`),this.element):(r.error(`Elemento n\xE3o encontrado: ${this.targetSelector}`),null)}catch(e){return r.error(`Erro ao montar UserDropdown: ${e.message}`),null}}unmount(){this._unbindEvents(),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.originalElement&&(this.originalElement.style.display="",r.debug("Elemento original restaurado")),this._mounted=!1}};var N={baseUrl:"https://services.leadconnectorhq.com",token:"pit-301590c6-a6cb-47d5-a7f4-bc5c4f5c22d4",version:"2021-07-28"};function we(){return{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${N.token}`,Version:N.version}}async function X(o){let e=`${N.baseUrl}/users/?locationId=${o}`,t=await fetch(e,{method:"GET",headers:we()});if(!t.ok)throw new Error(`Erro ao buscar usu\xE1rios: ${t.status}`);return(await t.json()).users||[]}function U(){let e=window.location.pathname.match(/\/location\/([^\/]+)/);return e?e[1]:null}function ee(){let e=window.location.pathname.match(/\/opportunities\/list\/([^\/\?]+)/);return e?e[1]:null}var D=class{constructor(){this.host=null,this.shadowRoot=null,this.contentWrapper=null,this._initialized=!1}async init(){if(this._initialized)return r.warn("Container j\xE1 inicializado"),this.contentWrapper;await Y();let e=l(),t=c();return this.host=k("div",{id:`${t}-host`,style:{all:"initial",position:"fixed",top:"0",left:"0",width:"0",height:"0",overflow:"visible",zIndex:e.zIndexBase.toString(),pointerEvents:"none"}}),e.cssIsolation==="shadow-dom"&&(this.shadowRoot=this.host.attachShadow({mode:"open"}),m.setShadowRoot(this.shadowRoot)),this.contentWrapper=k("div",{id:`${t}-content`,className:`${t}-root`,style:{all:"initial",display:"block"}}),(this.shadowRoot||this.host).appendChild(this.contentWrapper),m.injectBaseStyles(),this._mountToDOM(e),this._initialized=!0,r.debug("Container inicializado"),this.contentWrapper}_mountToDOM(e){let{mountTarget:t,mountPosition:n}=e;if(t){let i=document.querySelector(t);if(i){i.appendChild(this.host);return}r.warn(`Target "${t}" n\xE3o encontrado, usando body`)}n==="body-start"?document.body.insertBefore(this.host,document.body.firstChild):document.body.appendChild(this.host)}getContentRoot(){if(!this._initialized)throw new Error("Container n\xE3o inicializado. Chame init() primeiro.");return this.contentWrapper}getShadowRoot(){return this.shadowRoot}isInitialized(){return this._initialized}destroy(){this._initialized&&(m.clear(),this.host&&this.host.parentNode&&this.host.parentNode.removeChild(this.host),this.host=null,this.shadowRoot=null,this.contentWrapper=null,this._initialized=!1,r.debug("Container destru\xEDdo"))}},f=new D;var h={initialized:!1,destroyed:!1};async function b(o,...e){let n=l().hooks[o];if(typeof n=="function")try{await n(...e),r.debug(`Hook executado: ${o}`)}catch(i){r.error(`Erro no hook ${o}:`,i)}}async function B(o={}){if(h.initialized)return r.warn("Aplica\xE7\xE3o j\xE1 inicializada"),te();try{R(o);let e=l();return r.debug("Iniciando aplica\xE7\xE3o",e),await b("onBeforeInit"),await f.init(),u.emit("app:init",{config:e}),await b("onAfterInit"),h.initialized=!0,h.destroyed=!1,r.info("Aplica\xE7\xE3o inicializada com sucesso"),te()}catch(e){throw r.error("Falha na inicializa\xE7\xE3o:",e),await b("onError",e),e}}async function oe(){if(!(!h.initialized||h.destroyed))try{await b("onBeforeDestroy"),u.emit("app:destroy"),u.clear(),f.destroy(),await b("onAfterDestroy"),h.initialized=!1,h.destroyed=!0,r.info("Aplica\xE7\xE3o destru\xEDda")}catch(o){r.error("Erro ao destruir aplica\xE7\xE3o:",o)}}function te(){return{isInitialized:()=>h.initialized,getContainer:()=>f.getContentRoot(),getShadowRoot:()=>f.getShadowRoot(),on:(o,e)=>u.on(o,e),off:(o,e)=>u.off(o,e),emit:(o,e)=>u.emit(o,e),getConfig:l,setConfig:R,destroy:oe}}var M="ui-injector:route-change",ne="__uiInjectorHistoryPatched",S=new Set,ie=!1,F="",C=null;function I(o){let e=window.location.href;e!==F&&(F=e,S.forEach(t=>t({url:e,reason:o})))}function ye(){if(window[ne])return;let o=history.pushState,e=history.replaceState;history.pushState=function(...t){let n=o.apply(this,t);return window.dispatchEvent(new Event(M)),n},history.replaceState=function(...t){let n=e.apply(this,t);return window.dispatchEvent(new Event(M)),n},window[ne]=!0}function xe({pollInterval:o}){ie||(ie=!0,F=window.location.href,ye(),window.addEventListener(M,()=>I("history")),window.addEventListener("popstate",()=>I("popstate")),window.addEventListener("hashchange",()=>I("hashchange")),o>0&&(C=window.setInterval(()=>I("poll"),o)))}function re(o,e={}){return typeof window>"u"?()=>{}:(S.add(o),xe({pollInterval:typeof e.pollInterval=="number"?e.pollInterval:1e3}),()=>{S.delete(o),S.size===0&&C&&(clearInterval(C),C=null)})}var L="citQs4acsN1StzOEDuvj",E="#OpportunityOwner",H='[data-component-id^="user-dropdown"]',$=null,W=null,q=!1,P=!1,g=null,se=!1;function be(){return!!document.querySelector(H)}function Ee(){document.querySelectorAll(H).forEach(e=>e.remove());let o=document.querySelector(E);o&&(o.style.display="")}function ae(){return $}async function v(){try{d.info("Iniciando Switch User...");let o=U();if(o!==L){d.debug("Location n\xE3o permitida: "+o);return}await B({debug:!0,namespace:"ui-injector"}),d.debug("Buscando usu\xE1rios da API...");let e=await X(L);d.info(e.length+" usu\xE1rios carregados");let t=document.querySelector(E),n=0;for(;!t&&n<50;)await new Promise(i=>setTimeout(i,200)),t=document.querySelector(E),n++;if(!t){d.error(`Elemento ${E} n\xE3o encontrado`);return}document.querySelectorAll(H).forEach(i=>i.remove()),t.style.display="",$=new x({users:e,targetSelector:E,allowedLocationId:L}),$.on("user:selected",i=>{d.info("Selecionado: "+i.name)}),await $.mountReplacing(),d.info("Dropdown montado com "+e.length+" usu\xE1rios")}catch(o){d.error("Erro: "+o.message),console.error(o)}}async function ve(){q=!0;try{await v()}finally{q=!1,P&&(P=!1,G())}}function _e(){if(g&&(clearTimeout(g),g=null),q){P=!0;return}ve()}function G(){let o=U(),e=ee();if(o!==L||!e){Ee(),W=e;return}let t=e!==W;t&&(W=e),(t||!be())&&_e()}function Ie(){g||(g=setTimeout(()=>{g=null,G()},1e3))}function Se(){se||(se=!0,re(()=>{G()},{pollInterval:1e3}))}typeof window<"u"&&(window.UIInjector={start:v,init:v,getDropdown:ae},Se(),Ie());var Ce={start:v,init:v,getDropdown:ae};return me(Le);})();
