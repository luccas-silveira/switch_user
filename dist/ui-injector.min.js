var UIInjector=(()=>{var $=Object.defineProperty;var pe=Object.getOwnPropertyDescriptor;var he=Object.getOwnPropertyNames;var fe=Object.prototype.hasOwnProperty;var me=(o,e)=>{for(var t in e)$(o,t,{get:e[t],enumerable:!0})},ge=(o,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of he(e))!fe.call(o,i)&&i!==t&&$(o,i,{get:()=>e[i],enumerable:!(n=pe(e,i))||n.enumerable});return o};var we=o=>ge($({},"__esModule",{value:!0}),o);var Re={};me(Re,{default:()=>ze,getDropdown:()=>Q,init:()=>w,start:()=>w});var ye={namespace:"ui-injector",version:"1.0.0",debug:!1,cssIsolation:"shadow-dom",mountTarget:null,mountPosition:"body-end",zIndexBase:999e3,domTimeout:5e3,retryInterval:100,maxRetries:50,observeMutations:!0,hooks:{onBeforeInit:null,onAfterInit:null,onBeforeMount:null,onAfterMount:null,onBeforeDestroy:null,onAfterDestroy:null,onError:null}},x={...ye};function l(){return{...x}}function z(o){return x={...x,...o,hooks:{...x.hooks,...o.hooks||{}}},l()}function c(){return x.namespace}function R(o,e={}){let t=l(),{timeout:n=t.domTimeout,interval:i=t.retryInterval,parent:a=document}=e;return new Promise((r,y)=>{let _=a.querySelector(o);if(_){r(_);return}let ue=Date.now(),Y=setInterval(()=>{let K=a.querySelector(o);if(K){clearInterval(Y),r(K);return}Date.now()-ue>=n&&(clearInterval(Y),y(new Error(`Timeout: elemento "${o}" n\xE3o encontrado`)))},i)})}function Z(){return new Promise(o=>{document.readyState==="loading"?document.addEventListener("DOMContentLoaded",o,{once:!0}):o()})}function A(o,e={},t=[]){let n=document.createElement(o);return Object.entries(e).forEach(([a,r])=>{if(a==="className")n.className=r;else if(a==="style"&&typeof r=="object")Object.assign(n.style,r);else if(a.startsWith("on")&&typeof r=="function"){let y=a.slice(2).toLowerCase();n.addEventListener(y,r)}else a==="dataset"&&typeof r=="object"?Object.entries(r).forEach(([y,_])=>{n.dataset[y]=_}):n.setAttribute(a,r)}),(Array.isArray(t)?t:[t]).forEach(a=>{typeof a=="string"?n.appendChild(document.createTextNode(a)):a instanceof Node&&n.appendChild(a)}),n}function h(o,e){let t=c(),n=new Date().toISOString().split("T")[1].split(".")[0];return`[${t}][${n}][${o}] ${e}`}var d={debug(o,...e){l().debug&&console.log(h("DEBUG",o),...e)},info(o,...e){console.info(h("INFO",o),...e)},warn(o,...e){console.warn(h("WARN",o),...e)},error(o,...e){console.error(h("ERROR",o),...e);let t=l();if(t.hooks.onError)try{t.hooks.onError(new Error(o),e)}catch(n){console.error(h("ERROR","Erro no hook onError"),n)}},group(o,e){if(l().debug){console.groupCollapsed(h("GROUP",o));try{e()}finally{console.groupEnd()}}}},s=d;var k=class{constructor(){this.listeners=new Map}_prefixEvent(e){return`${c()}:${e}`}on(e,t){let n=this._prefixEvent(e);return this.listeners.has(n)||this.listeners.set(n,new Set),this.listeners.get(n).add(t),s.debug(`Listener registrado para evento: ${e}`),()=>this.off(e,t)}once(e,t){let n=(...i)=>{this.off(e,n),t(...i)};return this.on(e,n)}off(e,t){let n=this._prefixEvent(e),i=this.listeners.get(n);i&&(i.delete(t),i.size===0&&this.listeners.delete(n),s.debug(`Listener removido do evento: ${e}`))}emit(e,t){let n=this._prefixEvent(e),i=this.listeners.get(n);s.debug(`Evento emitido: ${e}`,t),i&&i.forEach(a=>{try{a(t)}catch(r){s.error(`Erro ao executar listener do evento ${e}:`,r)}})}clear(e){if(e){let t=this._prefixEvent(e);this.listeners.delete(t),s.debug(`Listeners limpos do evento: ${e}`)}else this.listeners.clear(),s.debug("Todos os listeners foram limpos")}},u=new k;var X=`
  :host {
    /* Cores prim\xE1rias */
    --ui-color-primary: #3b82f6;
    --ui-color-primary-hover: #2563eb;
    --ui-color-primary-light: #dbeafe;

    /* Cores de texto */
    --ui-color-text: #1f2937;
    --ui-color-text-muted: #6b7280;
    --ui-color-text-light: #9ca3af;

    /* Cores de fundo */
    --ui-color-bg: #ffffff;
    --ui-color-bg-secondary: #f9fafb;
    --ui-color-bg-tertiary: #f3f4f6;

    /* Cores de borda */
    --ui-color-border: #e5e7eb;
    --ui-color-border-dark: #d1d5db;

    /* Cores de status */
    --ui-color-success: #10b981;
    --ui-color-warning: #f59e0b;
    --ui-color-error: #ef4444;
    --ui-color-info: #3b82f6;

    /* Sombras */
    --ui-shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    --ui-shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    --ui-shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);

    /* Espa\xE7amento */
    --ui-spacing-xs: 4px;
    --ui-spacing-sm: 8px;
    --ui-spacing-md: 16px;
    --ui-spacing-lg: 24px;
    --ui-spacing-xl: 32px;

    /* Tipografia */
    --ui-font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    --ui-font-size-xs: 12px;
    --ui-font-size-sm: 14px;
    --ui-font-size-md: 16px;
    --ui-font-size-lg: 18px;
    --ui-font-size-xl: 20px;

    /* Bordas */
    --ui-radius-sm: 4px;
    --ui-radius-md: 6px;
    --ui-radius-lg: 8px;
    --ui-radius-full: 9999px;

    /* Transi\xE7\xF5es */
    --ui-transition-fast: 150ms ease;
    --ui-transition-normal: 250ms ease;
    --ui-transition-slow: 350ms ease;

    /* Z-index */
    --ui-z-dropdown: 100;
    --ui-z-modal: 200;
    --ui-z-tooltip: 300;
    --ui-z-toast: 400;
  }
`,ee=`
  *, *::before, *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  :host {
    font-family: var(--ui-font-family);
    font-size: var(--ui-font-size-md);
    color: var(--ui-color-text);
    line-height: 1.5;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  button, input, select, textarea {
    font-family: inherit;
    font-size: inherit;
  }

  button {
    cursor: pointer;
    border: none;
    background: none;
  }

  a {
    color: inherit;
    text-decoration: none;
  }

  img, svg {
    display: block;
    max-width: 100%;
  }

  [hidden] {
    display: none !important;
  }
`;function T(){return`${X}
${ee}`}var N=class{constructor(){this.styleSheets=new Map,this.shadowRoot=null}setShadowRoot(e){this.shadowRoot=e}_getStyleId(e){return`${c()}-style-${e}`}_prefixSelectors(e){let t=c();return e.replace(/([^\r\n,{}]+)(,(?=[^}]*{)|\s*{)/g,(n,i,a)=>{let r=i.trim();return r.startsWith("@")||r.startsWith(":root")||r.startsWith(":host")?n:`.${t} ${r}${a}`})}inject(e,t){let n=l(),i=this._getStyleId(e);this.remove(e);let a=t;n.cssIsolation==="prefixed"&&!this.shadowRoot&&(a=this._prefixSelectors(t));let r=document.createElement("style");return r.id=i,r.textContent=a,this.shadowRoot?this.shadowRoot.appendChild(r):document.head.appendChild(r),this.styleSheets.set(e,r),s.debug(`Estilo injetado: ${e}`),r}remove(e){let t=this.styleSheets.get(e);t&&t.parentNode&&(t.parentNode.removeChild(t),this.styleSheets.delete(e),s.debug(`Estilo removido: ${e}`))}injectBaseStyles(){this.inject("base",T())}clear(){this.styleSheets.forEach((e,t)=>this.remove(t)),s.debug("Todos os estilos foram removidos")}has(e){return this.styleSheets.has(e)}},f=new N;var xe="citQs4acsN1StzOEDuvj",b=class{constructor(e={}){this.id="user-dropdown-"+Math.random().toString(36).substring(2,9),this.targetSelector=e.targetSelector||"#OpportunityOwner",this.allowedLocationId=e.allowedLocationId||xe,this.originalElement=null,this.element=null,this._mounted=!1,this.state={isOpen:!1,users:e.users||[],selectedUser:null},this._eventListeners=[],this._handleToggle=this._handleToggle.bind(this),this._handleSelect=this._handleSelect.bind(this),this._handleClickOutside=this._handleClickOutside.bind(this)}on(e,t){this._eventListeners.push({event:e,callback:t})}emit(e,t){this._eventListeners.filter(n=>n.event===e).forEach(n=>n.callback(t))}setState(e){this.state={...this.state,...e},this._mounted&&this._rerender()}setUsers(e){this.setState({users:e||[]})}_getStyles(){return`
      <style>
        .ud-container {
          position: relative;
          display: inline-block;
          width: 100%;
          font-family: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
          font-size: 14px;
        }

        .ud-trigger {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 9px 12px;
          background: #fff;
          border: 1px solid #e2e8f0;
          border-radius: 8px;
          cursor: pointer;
          min-height: 40px;
          transition: all 0.15s ease;
          width: 100%;
          box-sizing: border-box;
        }

        .ud-trigger:hover {
          border-color: #cbd5e1;
        }

        .ud-trigger.open {
          border-color: #3b82f6;
          box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .ud-value {
          flex: 1;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
          color: #1e293b;
        }

        .ud-placeholder {
          color: #94a3b8;
        }

        .ud-arrow {
          margin-left: 8px;
          width: 20px;
          height: 20px;
          display: flex;
          align-items: center;
          justify-content: center;
          color: #64748b;
          transition: transform 0.2s ease;
        }

        .ud-arrow.open {
          transform: rotate(180deg);
        }

        .ud-arrow svg {
          width: 16px;
          height: 16px;
        }

        .ud-list {
          position: absolute;
          top: calc(100% + 4px);
          left: 0;
          right: 0;
          background: #fff;
          border: 1px solid #e2e8f0;
          border-radius: 8px;
          box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
          max-height: 280px;
          overflow-y: auto;
          z-index: 99999;
          display: none;
        }

        .ud-list.open {
          display: block;
        }

        .ud-item {
          padding: 10px 14px;
          cursor: pointer;
          transition: background-color 0.1s ease;
          border-bottom: 1px solid #f1f5f9;
        }

        .ud-item:last-child {
          border-bottom: none;
        }

        .ud-item:hover {
          background-color: #f8fafc;
        }

        .ud-item.selected {
          background-color: #eff6ff;
        }

        .ud-item-name {
          font-weight: 500;
          color: #1e293b;
          font-size: 14px;
        }

        .ud-empty {
          padding: 16px;
          text-align: center;
          color: #94a3b8;
        }
      </style>
    `}_getArrowIcon(){return`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd" />
    </svg>`}_escapeHtml(e){let t=document.createElement("div");return t.textContent=e||"",t.innerHTML}_render(){let{isOpen:e,users:t,selectedUser:n}=this.state,i=n?`<span class="ud-value">${this._escapeHtml(n.name)}</span>`:'<span class="ud-value ud-placeholder">Selecione um usu\xE1rio</span>',a=t.length>0?t.map(r=>`
          <div class="ud-item${n?.id===r.id?" selected":""}" data-user-id="${r.id}">
            <div class="ud-item-name">${this._escapeHtml(r.name)}</div>
          </div>
        `).join(""):'<div class="ud-empty">Nenhum usu\xE1rio dispon\xEDvel</div>';return`
      ${this._getStyles()}
      <div class="ud-container" data-component-id="${this.id}">
        <div class="ud-trigger${e?" open":""}">
          ${i}
          <span class="ud-arrow${e?" open":""}">${this._getArrowIcon()}</span>
        </div>
        <div class="ud-list${e?" open":""}">
          ${a}
        </div>
      </div>
    `}_createElement(){let e=document.createElement("div");return e.innerHTML=this._render(),e}_rerender(){if(!this.element||!this.element.parentNode)return;let e=this.element.parentNode,t=this._createElement();e.replaceChild(t,this.element),this.element=t,this._bindEvents(),s.debug(`Componente re-renderizado: ${this.id}`)}_getLocationIdFromUrl(){let t=window.location.pathname.match(/\/location\/([^\/]+)/);return t?t[1]:null}_isAllowedLocation(){return this._getLocationIdFromUrl()===this.allowedLocationId}_handleToggle(e){e.stopPropagation(),e.preventDefault(),this.setState({isOpen:!this.state.isOpen})}_handleSelect(e){let t=e.target.closest(".ud-item");if(!t)return;let n=t.dataset.userId,i=this.state.users.find(a=>a.id===n);i&&(this.setState({selectedUser:i,isOpen:!1}),this.emit("user:selected",i),s.debug(`Usu\xE1rio selecionado: ${i.name}`))}_handleClickOutside(e){this.element&&!this.element.contains(e.target)&&this.state.isOpen&&this.setState({isOpen:!1})}_bindEvents(){if(!this.element)return;let e=this.element.querySelector(".ud-trigger"),t=this.element.querySelector(".ud-list");e&&e.addEventListener("click",this._handleToggle),t&&t.addEventListener("click",this._handleSelect),document.removeEventListener("click",this._handleClickOutside),document.addEventListener("click",this._handleClickOutside)}_unbindEvents(){document.removeEventListener("click",this._handleClickOutside)}async mountReplacing(){try{if(!this._isAllowedLocation()){let e=this._getLocationIdFromUrl();return s.debug(`UserDropdown n\xE3o exibido: locationId atual (${e}) diferente do permitido (${this.allowedLocationId})`),null}return this.originalElement=await R(this.targetSelector,{timeout:1e4}),this.originalElement?(this.originalElement.style.display="none",this.element=this._createElement(),this.originalElement.parentNode.insertBefore(this.element,this.originalElement.nextSibling),this._mounted=!0,this._bindEvents(),s.debug(`UserDropdown montado substituindo: ${this.targetSelector}`),this.element):(s.error(`Elemento n\xE3o encontrado: ${this.targetSelector}`),null)}catch(e){return s.error(`Erro ao montar UserDropdown: ${e.message}`),null}}unmount(){this._unbindEvents(),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.originalElement&&(this.originalElement.style.display="",s.debug("Elemento original restaurado")),this._mounted=!1}};var j={baseUrl:"https://services.leadconnectorhq.com",token:"pit-301590c6-a6cb-47d5-a7f4-bc5c4f5c22d4",version:"2021-07-28"};function be(){return{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${j.token}`,Version:j.version}}async function oe(o){let e=`${j.baseUrl}/users/?locationId=${o}`,t=await fetch(e,{method:"GET",headers:be()});if(!t.ok)throw new Error(`Erro ao buscar usu\xE1rios: ${t.status}`);return(await t.json()).users||[]}function U(){let e=window.location.pathname.match(/\/location\/([^\/]+)/);return e?e[1]:null}var D={baseUrl:"https://services.leadconnectorhq.com",token:"pit-301590c6-a6cb-47d5-a7f4-bc5c4f5c22d4",version:"2021-07-28"};async function ne(o,e){let t=`${D.baseUrl}/opportunities/${o}`,n={Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${D.token}`,Version:D.version},a=await fetch(t,{method:"PUT",headers:n,body:JSON.stringify({assignedTo:e})}),r=await a.json();return{ok:a.ok,status:a.status,data:r}}function B(){let e=window.location.pathname.match(/\/opportunities\/list\/([^\/\?]+)/);return e?e[1]:null}function Ee(){let o=document.querySelectorAll("span");for(let e of o)if(e.textContent?.includes("Registros de auditoria:")){let t=e.querySelector("span.cursor-pointer");if(t)return t.textContent?.trim()||null}return null}function ie(){return Ee()||B()}var M=class{constructor(){this.host=null,this.shadowRoot=null,this.contentWrapper=null,this._initialized=!1}async init(){if(this._initialized)return s.warn("Container j\xE1 inicializado"),this.contentWrapper;await Z();let e=l(),t=c();return this.host=A("div",{id:`${t}-host`,style:{all:"initial",position:"fixed",top:"0",left:"0",width:"0",height:"0",overflow:"visible",zIndex:e.zIndexBase.toString(),pointerEvents:"none"}}),e.cssIsolation==="shadow-dom"&&(this.shadowRoot=this.host.attachShadow({mode:"open"}),f.setShadowRoot(this.shadowRoot)),this.contentWrapper=A("div",{id:`${t}-content`,className:`${t}-root`,style:{all:"initial",display:"block"}}),(this.shadowRoot||this.host).appendChild(this.contentWrapper),f.injectBaseStyles(),this._mountToDOM(e),this._initialized=!0,s.debug("Container inicializado"),this.contentWrapper}_mountToDOM(e){let{mountTarget:t,mountPosition:n}=e;if(t){let i=document.querySelector(t);if(i){i.appendChild(this.host);return}s.warn(`Target "${t}" n\xE3o encontrado, usando body`)}n==="body-start"?document.body.insertBefore(this.host,document.body.firstChild):document.body.appendChild(this.host)}getContentRoot(){if(!this._initialized)throw new Error("Container n\xE3o inicializado. Chame init() primeiro.");return this.contentWrapper}getShadowRoot(){return this.shadowRoot}isInitialized(){return this._initialized}destroy(){this._initialized&&(f.clear(),this.host&&this.host.parentNode&&this.host.parentNode.removeChild(this.host),this.host=null,this.shadowRoot=null,this.contentWrapper=null,this._initialized=!1,s.debug("Container destru\xEDdo"))}},m=new M;var p={initialized:!1,destroyed:!1};async function E(o,...e){let n=l().hooks[o];if(typeof n=="function")try{await n(...e),s.debug(`Hook executado: ${o}`)}catch(i){s.error(`Erro no hook ${o}:`,i)}}async function F(o={}){if(p.initialized)return s.warn("Aplica\xE7\xE3o j\xE1 inicializada"),re();try{z(o);let e=l();return s.debug("Iniciando aplica\xE7\xE3o",e),await E("onBeforeInit"),await m.init(),u.emit("app:init",{config:e}),await E("onAfterInit"),p.initialized=!0,p.destroyed=!1,s.info("Aplica\xE7\xE3o inicializada com sucesso"),re()}catch(e){throw s.error("Falha na inicializa\xE7\xE3o:",e),await E("onError",e),e}}async function se(){if(!(!p.initialized||p.destroyed))try{await E("onBeforeDestroy"),u.emit("app:destroy"),u.clear(),m.destroy(),await E("onAfterDestroy"),p.initialized=!1,p.destroyed=!0,s.info("Aplica\xE7\xE3o destru\xEDda")}catch(o){s.error("Erro ao destruir aplica\xE7\xE3o:",o)}}function re(){return{isInitialized:()=>p.initialized,getContainer:()=>m.getContentRoot(),getShadowRoot:()=>m.getShadowRoot(),on:(o,e)=>u.on(o,e),off:(o,e)=>u.off(o,e),emit:(o,e)=>u.emit(o,e),getConfig:l,setConfig:z,destroy:se}}var q="ui-injector:route-change",ae="__uiInjectorHistoryPatched",S=new Set,le=!1,W="",C=null;function I(o){let e=window.location.href;e!==W&&(W=e,S.forEach(t=>t({url:e,reason:o})))}function ve(){if(window[ae])return;let o=history.pushState,e=history.replaceState;history.pushState=function(...t){let n=o.apply(this,t);return window.dispatchEvent(new Event(q)),n},history.replaceState=function(...t){let n=e.apply(this,t);return window.dispatchEvent(new Event(q)),n},window[ae]=!0}function _e({pollInterval:o}){le||(le=!0,W=window.location.href,ve(),window.addEventListener(q,()=>I("history")),window.addEventListener("popstate",()=>I("popstate")),window.addEventListener("hashchange",()=>I("hashchange")),o>0&&(C=window.setInterval(()=>I("poll"),o)))}function de(o,e={}){return typeof window>"u"?()=>{}:(S.add(o),_e({pollInterval:typeof e.pollInterval=="number"?e.pollInterval:1e3}),()=>{S.delete(o),S.size===0&&C&&(clearInterval(C),C=null)})}var O="citQs4acsN1StzOEDuvj",v="#OpportunityOwner",V='[data-component-id^="user-dropdown"]',L=null,P=null,H=!1,G=!1,g=null,ce=!1;function Ie(){return!!document.querySelector(V)}function Se(){document.querySelectorAll(V).forEach(e=>e.remove());let o=document.querySelector(v);o&&(o.style.display="")}function Q(){return L}async function w(){try{d.info("Iniciando Switch User...");let o=U();if(o!==O){d.debug("Location n\xE3o permitida: "+o);return}await F({debug:!0,namespace:"ui-injector"}),d.debug("Buscando usu\xE1rios da API...");let e=await oe(O);d.info(e.length+" usu\xE1rios carregados");let t=document.querySelector(v),n=0;for(;!t&&n<50;)await new Promise(i=>setTimeout(i,200)),t=document.querySelector(v),n++;if(!t){d.error(`Elemento ${v} n\xE3o encontrado`);return}document.querySelectorAll(V).forEach(i=>i.remove()),t.style.display="",L=new b({users:e,targetSelector:v,allowedLocationId:O}),L.on("user:selected",async i=>{let a=ie();if(!a){d.error("Opportunity ID n\xE3o encontrado");return}d.info("Atualizando owner para: "+i.name);try{let r=await ne(a,i.id);r.ok?d.info("Owner atualizado com sucesso"):d.error("Falha ao atualizar: "+JSON.stringify(r.data))}catch(r){d.error("Erro ao atualizar owner: "+r.message)}}),await L.mountReplacing(),d.info("Dropdown montado com "+e.length+" usu\xE1rios")}catch(o){d.error("Erro: "+o.message),console.error(o)}}async function Ce(){H=!0;try{await w()}finally{H=!1,G&&(G=!1,J())}}function Oe(){if(g&&(clearTimeout(g),g=null),H){G=!0;return}Ce()}function J(){let o=U(),e=B();if(o!==O||!e){Se(),P=e;return}let t=e!==P;t&&(P=e),(t||!Ie())&&Oe()}function Le(){g||(g=setTimeout(()=>{g=null,J()},1e3))}function $e(){ce||(ce=!0,de(()=>{J()},{pollInterval:1e3}))}typeof window<"u"&&(window.UIInjector={start:w,init:w,getDropdown:Q},$e(),Le());var ze={start:w,init:w,getDropdown:Q};return we(Re);})();
