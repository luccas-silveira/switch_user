var UIInjector=(()=>{var f=Object.defineProperty;var D=Object.getOwnPropertyDescriptor;var z=Object.getOwnPropertyNames;var T=Object.prototype.hasOwnProperty;var M=(o,e)=>{for(var t in e)f(o,t,{get:e[t],enumerable:!0})},j=(o,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of z(e))!T.call(o,r)&&r!==t&&f(o,r,{get:()=>e[r],enumerable:!(n=D(e,r))||n.enumerable});return o};var B=o=>j(f({},"__esModule",{value:!0}),o);var Q={};M(Q,{default:()=>V,getDropdown:()=>v,startApp:()=>m});var F={namespace:"ui-injector",version:"1.0.0",debug:!1,cssIsolation:"shadow-dom",mountTarget:null,mountPosition:"body-end",zIndexBase:999e3,domTimeout:5e3,retryInterval:100,maxRetries:50,observeMutations:!0,hooks:{onBeforeInit:null,onAfterInit:null,onBeforeMount:null,onAfterMount:null,onBeforeDestroy:null,onAfterDestroy:null,onError:null}},L={...F};function d(){return{...L}}function c(){return L.namespace}function g(o,e={}){let t=d(),{timeout:n=t.domTimeout,interval:r=t.retryInterval,parent:a=document}=e;return new Promise((s,k)=>{let _=a.querySelector(o);if(_){s(_);return}let A=Date.now(),S=setInterval(()=>{let I=a.querySelector(o);if(I){clearInterval(S),s(I);return}Date.now()-A>=n&&(clearInterval(S),k(new Error(`Timeout: elemento "${o}" n\xE3o encontrado`)))},r)})}function u(o,e){let t=c(),n=new Date().toISOString().split("T")[1].split(".")[0];return`[${t}][${n}][${o}] ${e}`}var q={debug(o,...e){d().debug&&console.log(u("DEBUG",o),...e)},info(o,...e){console.info(u("INFO",o),...e)},warn(o,...e){console.warn(u("WARN",o),...e)},error(o,...e){console.error(u("ERROR",o),...e);let t=d();if(t.hooks.onError)try{t.hooks.onError(new Error(o),e)}catch(n){console.error(u("ERROR","Erro no hook onError"),n)}},group(o,e){if(d().debug){console.groupCollapsed(u("GROUP",o));try{e()}finally{console.groupEnd()}}}},i=q;var x=class{constructor(){this.listeners=new Map}_prefixEvent(e){return`${c()}:${e}`}on(e,t){let n=this._prefixEvent(e);return this.listeners.has(n)||this.listeners.set(n,new Set),this.listeners.get(n).add(t),i.debug(`Listener registrado para evento: ${e}`),()=>this.off(e,t)}once(e,t){let n=(...r)=>{this.off(e,n),t(...r)};return this.on(e,n)}off(e,t){let n=this._prefixEvent(e),r=this.listeners.get(n);r&&(r.delete(t),r.size===0&&this.listeners.delete(n),i.debug(`Listener removido do evento: ${e}`))}emit(e,t){let n=this._prefixEvent(e),r=this.listeners.get(n);i.debug(`Evento emitido: ${e}`,t),r&&r.forEach(a=>{try{a(t)}catch(s){i.error(`Erro ao executar listener do evento ${e}:`,s)}})}clear(e){if(e){let t=this._prefixEvent(e);this.listeners.delete(t),i.debug(`Listeners limpos do evento: ${e}`)}else this.listeners.clear(),i.debug("Todos os listeners foram limpos")}},P=new x;var C=`
  :host {
    /* Cores prim\xE1rias */
    --ui-color-primary: #3b82f6;
    --ui-color-primary-hover: #2563eb;
    --ui-color-primary-light: #dbeafe;

    /* Cores de texto */
    --ui-color-text: #1f2937;
    --ui-color-text-muted: #6b7280;
    --ui-color-text-light: #9ca3af;

    /* Cores de fundo */
    --ui-color-bg: #ffffff;
    --ui-color-bg-secondary: #f9fafb;
    --ui-color-bg-tertiary: #f3f4f6;

    /* Cores de borda */
    --ui-color-border: #e5e7eb;
    --ui-color-border-dark: #d1d5db;

    /* Cores de status */
    --ui-color-success: #10b981;
    --ui-color-warning: #f59e0b;
    --ui-color-error: #ef4444;
    --ui-color-info: #3b82f6;

    /* Sombras */
    --ui-shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    --ui-shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    --ui-shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);

    /* Espa\xE7amento */
    --ui-spacing-xs: 4px;
    --ui-spacing-sm: 8px;
    --ui-spacing-md: 16px;
    --ui-spacing-lg: 24px;
    --ui-spacing-xl: 32px;

    /* Tipografia */
    --ui-font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    --ui-font-size-xs: 12px;
    --ui-font-size-sm: 14px;
    --ui-font-size-md: 16px;
    --ui-font-size-lg: 18px;
    --ui-font-size-xl: 20px;

    /* Bordas */
    --ui-radius-sm: 4px;
    --ui-radius-md: 6px;
    --ui-radius-lg: 8px;
    --ui-radius-full: 9999px;

    /* Transi\xE7\xF5es */
    --ui-transition-fast: 150ms ease;
    --ui-transition-normal: 250ms ease;
    --ui-transition-slow: 350ms ease;

    /* Z-index */
    --ui-z-dropdown: 100;
    --ui-z-modal: 200;
    --ui-z-tooltip: 300;
    --ui-z-toast: 400;
  }
`,O=`
  *, *::before, *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  :host {
    font-family: var(--ui-font-family);
    font-size: var(--ui-font-size-md);
    color: var(--ui-color-text);
    line-height: 1.5;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  button, input, select, textarea {
    font-family: inherit;
    font-size: inherit;
  }

  button {
    cursor: pointer;
    border: none;
    background: none;
  }

  a {
    color: inherit;
    text-decoration: none;
  }

  img, svg {
    display: block;
    max-width: 100%;
  }

  [hidden] {
    display: none !important;
  }
`;function b(){return`${C}
${O}`}var w=class{constructor(){this.styleSheets=new Map,this.shadowRoot=null}setShadowRoot(e){this.shadowRoot=e}_getStyleId(e){return`${c()}-style-${e}`}_prefixSelectors(e){let t=c();return e.replace(/([^\r\n,{}]+)(,(?=[^}]*{)|\s*{)/g,(n,r,a)=>{let s=r.trim();return s.startsWith("@")||s.startsWith(":root")||s.startsWith(":host")?n:`.${t} ${s}${a}`})}inject(e,t){let n=d(),r=this._getStyleId(e);this.remove(e);let a=t;n.cssIsolation==="prefixed"&&!this.shadowRoot&&(a=this._prefixSelectors(t));let s=document.createElement("style");return s.id=r,s.textContent=a,this.shadowRoot?this.shadowRoot.appendChild(s):document.head.appendChild(s),this.styleSheets.set(e,s),i.debug(`Estilo injetado: ${e}`),s}remove(e){let t=this.styleSheets.get(e);t&&t.parentNode&&(t.parentNode.removeChild(t),this.styleSheets.delete(e),i.debug(`Estilo removido: ${e}`))}injectBaseStyles(){this.inject("base",b())}clear(){this.styleSheets.forEach((e,t)=>this.remove(t)),i.debug("Todos os estilos foram removidos")}has(e){return this.styleSheets.has(e)}},$=new w;var W="citQs4acsN1StzOEDuvj",p=class{constructor(e={}){this.id="user-dropdown-"+Math.random().toString(36).substring(2,9),this.targetSelector=e.targetSelector||"#OpportunityOwner",this.allowedLocationId=e.allowedLocationId||W,this.originalElement=null,this.element=null,this._mounted=!1,this.state={isOpen:!1,users:e.users||[],selectedUser:null},this._eventListeners=[],this._handleToggle=this._handleToggle.bind(this),this._handleSelect=this._handleSelect.bind(this),this._handleClickOutside=this._handleClickOutside.bind(this)}on(e,t){this._eventListeners.push({event:e,callback:t})}emit(e,t){this._eventListeners.filter(n=>n.event===e).forEach(n=>n.callback(t))}setState(e){this.state={...this.state,...e},this._mounted&&this._rerender()}setUsers(e){this.setState({users:e||[]})}_getStyles(){return`
      <style>
        .ud-container {
          position: relative;
          display: inline-block;
          width: 100%;
          font-family: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
          font-size: 14px;
        }

        .ud-trigger {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 9px 12px;
          background: #fff;
          border: 1px solid #e2e8f0;
          border-radius: 8px;
          cursor: pointer;
          min-height: 40px;
          transition: all 0.15s ease;
          width: 100%;
          box-sizing: border-box;
        }

        .ud-trigger:hover {
          border-color: #cbd5e1;
        }

        .ud-trigger.open {
          border-color: #3b82f6;
          box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .ud-value {
          flex: 1;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
          color: #1e293b;
        }

        .ud-placeholder {
          color: #94a3b8;
        }

        .ud-arrow {
          margin-left: 8px;
          width: 20px;
          height: 20px;
          display: flex;
          align-items: center;
          justify-content: center;
          color: #64748b;
          transition: transform 0.2s ease;
        }

        .ud-arrow.open {
          transform: rotate(180deg);
        }

        .ud-arrow svg {
          width: 16px;
          height: 16px;
        }

        .ud-list {
          position: absolute;
          top: calc(100% + 4px);
          left: 0;
          right: 0;
          background: #fff;
          border: 1px solid #e2e8f0;
          border-radius: 8px;
          box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
          max-height: 280px;
          overflow-y: auto;
          z-index: 99999;
          display: none;
        }

        .ud-list.open {
          display: block;
        }

        .ud-item {
          padding: 10px 14px;
          cursor: pointer;
          transition: background-color 0.1s ease;
          border-bottom: 1px solid #f1f5f9;
        }

        .ud-item:last-child {
          border-bottom: none;
        }

        .ud-item:hover {
          background-color: #f8fafc;
        }

        .ud-item.selected {
          background-color: #eff6ff;
        }

        .ud-item-name {
          font-weight: 500;
          color: #1e293b;
          font-size: 14px;
        }

        .ud-empty {
          padding: 16px;
          text-align: center;
          color: #94a3b8;
        }
      </style>
    `}_getArrowIcon(){return`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd" />
    </svg>`}_escapeHtml(e){let t=document.createElement("div");return t.textContent=e||"",t.innerHTML}_render(){let{isOpen:e,users:t,selectedUser:n}=this.state,r=n?`<span class="ud-value">${this._escapeHtml(n.name)}</span>`:'<span class="ud-value ud-placeholder">Selecione um usu\xE1rio</span>',a=t.length>0?t.map(s=>`
          <div class="ud-item${n?.id===s.id?" selected":""}" data-user-id="${s.id}">
            <div class="ud-item-name">${this._escapeHtml(s.name)}</div>
          </div>
        `).join(""):'<div class="ud-empty">Nenhum usu\xE1rio dispon\xEDvel</div>';return`
      ${this._getStyles()}
      <div class="ud-container" data-component-id="${this.id}">
        <div class="ud-trigger${e?" open":""}">
          ${r}
          <span class="ud-arrow${e?" open":""}">${this._getArrowIcon()}</span>
        </div>
        <div class="ud-list${e?" open":""}">
          ${a}
        </div>
      </div>
    `}_createElement(){let e=document.createElement("div");return e.innerHTML=this._render(),e}_rerender(){if(!this.element||!this.element.parentNode)return;let e=this.element.parentNode,t=this._createElement();e.replaceChild(t,this.element),this.element=t,this._bindEvents(),i.debug(`Componente re-renderizado: ${this.id}`)}_getLocationIdFromUrl(){let t=window.location.pathname.match(/\/location\/([^\/]+)/);return t?t[1]:null}_isAllowedLocation(){return this._getLocationIdFromUrl()===this.allowedLocationId}_handleToggle(e){e.stopPropagation(),e.preventDefault(),this.setState({isOpen:!this.state.isOpen})}_handleSelect(e){let t=e.target.closest(".ud-item");if(!t)return;let n=t.dataset.userId,r=this.state.users.find(a=>a.id===n);r&&(this.setState({selectedUser:r,isOpen:!1}),this.emit("user:selected",r),i.debug(`Usu\xE1rio selecionado: ${r.name}`))}_handleClickOutside(e){this.element&&!this.element.contains(e.target)&&this.state.isOpen&&this.setState({isOpen:!1})}_bindEvents(){if(!this.element)return;let e=this.element.querySelector(".ud-trigger"),t=this.element.querySelector(".ud-list");e&&e.addEventListener("click",this._handleToggle),t&&t.addEventListener("click",this._handleSelect),document.removeEventListener("click",this._handleClickOutside),document.addEventListener("click",this._handleClickOutside)}_unbindEvents(){document.removeEventListener("click",this._handleClickOutside)}async mountReplacing(){try{if(!this._isAllowedLocation()){let e=this._getLocationIdFromUrl();return i.debug(`UserDropdown n\xE3o exibido: locationId atual (${e}) diferente do permitido (${this.allowedLocationId})`),null}return this.originalElement=await g(this.targetSelector,{timeout:1e4}),this.originalElement?(this.originalElement.style.display="none",this.element=this._createElement(),this.originalElement.parentNode.insertBefore(this.element,this.originalElement.nextSibling),this._mounted=!0,this._bindEvents(),i.debug(`UserDropdown montado substituindo: ${this.targetSelector}`),this.element):(i.error(`Elemento n\xE3o encontrado: ${this.targetSelector}`),null)}catch(e){return i.error(`Erro ao montar UserDropdown: ${e.message}`),null}}unmount(){this._unbindEvents(),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.originalElement&&(this.originalElement.style.display="",i.debug("Elemento original restaurado")),this._mounted=!1}};var y={baseUrl:"https://services.leadconnectorhq.com",token:"pit-301590c6-a6cb-47d5-a7f4-bc5c4f5c22d4",version:"2021-07-28"};function H(){return{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${y.token}`,Version:y.version}}async function N(o){let e=`${y.baseUrl}/users/?locationId=${o}`,t=await fetch(e,{method:"GET",headers:H()});if(!t.ok)throw new Error(`Erro ao buscar usu\xE1rios: ${t.status}`);return(await t.json()).users||[]}function U(){let e=window.location.pathname.match(/\/location\/([^\/]+)/);return e?e[1]:null}var E="citQs4acsN1StzOEDuvj",h=null;function l(o,e){console.log(`[SwitchUser] ${o}`,e||"")}function G(){document.querySelectorAll('[data-component-id^="user-dropdown"]').forEach(t=>t.parentNode?.removeChild(t));let e=document.querySelector("#OpportunityOwner");e&&(e.style.display="")}async function m(){try{l("Iniciando...");let o=U();if(o!==E)return l("Location n\xE3o permitida:",o),null;l("Location OK:",o),G(),l("Buscando usu\xE1rios...");let e=await N(E);if(l("Usu\xE1rios carregados:",e.length),!e||e.length===0)return l("ERRO: Nenhum usu\xE1rio retornado da API"),null;let t=0,n=document.querySelector("#OpportunityOwner");for(;!n&&t<50;)await new Promise(r=>setTimeout(r,200)),n=document.querySelector("#OpportunityOwner"),t++;return n?(l("Criando dropdown com",e.length,"usu\xE1rios"),h=new p({users:e,targetSelector:"#OpportunityOwner",allowedLocationId:E}),h.on("user:selected",r=>{l("Selecionado:",r.name)}),await h.mountReplacing(),l("Pronto! Dropdown montado com",h.state.users.length,"usu\xE1rios"),{dropdown:h,users:e}):(l("ERRO: Elemento #OpportunityOwner n\xE3o encontrado"),null)}catch(o){throw l("ERRO:",o.message),console.error(o),o}}function v(){return h}typeof window<"u"&&(window.SwitchUser={start:m,getDropdown:v},setTimeout(()=>{m()},1e3));var V={startApp:m,getDropdown:v};return B(Q);})();
